{"remainingRequest":"/Users/EGGROLL/Sites/gp-voting-page/node_modules/babel-loader/lib/index.js!/Users/EGGROLL/Sites/gp-voting-page/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/EGGROLL/Sites/gp-voting-page/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/EGGROLL/Sites/gp-voting-page/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/EGGROLL/Sites/gp-voting-page/src/App.vue","mtime":1569225010946},{"path":"/Users/EGGROLL/Sites/gp-voting-page/node_modules/cache-loader/dist/cjs.js","mtime":1551074536132},{"path":"/Users/EGGROLL/Sites/gp-voting-page/node_modules/babel-loader/lib/index.js","mtime":1560932818402},{"path":"/Users/EGGROLL/Sites/gp-voting-page/node_modules/cache-loader/dist/cjs.js","mtime":1551074536132},{"path":"/Users/EGGROLL/Sites/gp-voting-page/node_modules/vue-loader/lib/index.js","mtime":1568550729026}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/EGGROLL/Sites/gp-voting-page/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport SelectMartBlock from \"./components/SelectMartBlock.vue\";\nimport OrderMartBlock from \"./components/OrderMartBlock.vue\";\nimport BlankBlock from \"./components/BlankBlock.vue\";\nimport FooterBTN from \"./components/FooterBTN.vue\";\nimport config from \"./config/config\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\nexport default {\n  name: \"app\",\n  data: function data() {\n    return {\n      // headerText: \"臺灣9大連鎖零售業中，你最想先看到哪家達成減塑\",\n      window: {\n        width: 0,\n        height: 0\n      },\n      mobile: false,\n      userVoted: false,\n      userOption: false,\n      show: false,\n      dataLoading: false,\n      ip: \"\",\n      statistics: [],\n      orderedMarts: [],\n      resultDialogVisible: false,\n      marts: [{\n        img: require(\"@/assets/img/family-mart.png\"),\n        mart: \"全家\",\n        martEng: \"FamilyMart\",\n        selected: false\n      }, {\n        img: require(\"@/assets/img/carrefour.png\"),\n        mart: \"家樂福\",\n        martEng: \"Carrefour\",\n        selected: false\n      }, {\n        img: require(\"@/assets/img/costco.png\"),\n        mart: \"好市多\",\n        martEng: \"Costco\",\n        selected: false\n      }, {\n        img: require(\"@/assets/img/px-mart.png\"),\n        mart: \"全聯\",\n        martEng: \"PX Mart\",\n        selected: false\n      }, {\n        img: require(\"@/assets/img/rt-mart.png\"),\n        mart: \"大潤發\",\n        martEng: \"RT-Mart\",\n        selected: false\n      }, {\n        img: require(\"@/assets/img/7-11.jpg\"),\n        mart: \"7-ELEVEN\",\n        martEng: \"7-ELEVEN\",\n        selected: false\n      }, {\n        img: require(\"@/assets/img/wellcome.jpg\"),\n        mart: \"頂好\",\n        martEng: \"Wellcome\",\n        selected: false\n      }, {\n        img: require(\"@/assets/img/simple-mart.png\"),\n        mart: \"美廉社\",\n        martEng: \"Simple Mart\",\n        selected: false\n      }, {\n        img: require(\"@/assets/img/a-mart.png\"),\n        mart: \"愛買\",\n        martEng: \"a.mart\",\n        selected: false\n      }]\n    };\n  },\n  components: {\n    SelectMartBlock: SelectMartBlock,\n    OrderMartBlock: OrderMartBlock,\n    FooterBTN: FooterBTN,\n    BlankBlock: BlankBlock\n  },\n  created: function () {\n    var _created = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              window.addEventListener(\"resize\", this.handleResize);\n              this.handleResize();\n              _context.next = 4;\n              return this.getIP();\n\n            case 4:\n              this.getData();\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function created() {\n      return _created.apply(this, arguments);\n    }\n\n    return created;\n  }(),\n  methods: {\n    getIP: function () {\n      var _getIP = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var ipRef, ip;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return axios.get(\"https://api.ipify.org?format=json&callback=\");\n\n              case 2:\n                ipRef = _context2.sent;\n                ip = ipRef.data.ip;\n                this.ip = ip;\n                this.show = true;\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getIP() {\n        return _getIP.apply(this, arguments);\n      }\n\n      return getIP;\n    }(),\n    getData: function () {\n      var _getData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var data, resRef, res;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                this.dataLoading = true;\n                data = new FormData();\n                _context3.next = 5;\n                return axios.get(\"\".concat(config.scriptURL, \"?ip=\").concat(this.ip));\n\n              case 5:\n                resRef = _context3.sent;\n                res = resRef.data;\n                this.userOption = res.target; // console.log(this.userOption);\n\n                this.statistics = res.data;\n\n                if (this.userOption.Name) {\n                  this.userVoted = true;\n                } else {\n                  this.marts = this.shuffle(this.marts);\n                }\n\n                this.filterStatiscs();\n                this.dataLoading = false;\n                _context3.next = 17;\n                break;\n\n              case 14:\n                _context3.prev = 14;\n                _context3.t0 = _context3[\"catch\"](0);\n                console.log(_context3.t0);\n\n              case 17:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this, [[0, 14]]);\n      }));\n\n      function getData() {\n        return _getData.apply(this, arguments);\n      }\n\n      return getData;\n    }(),\n    filterStatiscs: function filterStatiscs() {\n      var _this = this;\n\n      this.orderedMarts = [];\n      this.statistics.sort(function (a, b) {\n        return b.Count - a.Count;\n      });\n      var rank = 1;\n      var largestCount = Math.max.apply(Math, this.statistics.map(function (o) {\n        return o.Count;\n      }));\n\n      var _loop = function _loop(i) {\n        var op = _this.statistics[i];\n\n        var item = _this.marts.find(function (element) {\n          return element.mart === op.Name;\n        });\n\n        if (item.mart === _this.userOption.Name) {\n          item.selected = true;\n        }\n\n        item.count = _this.statistics[i].Count;\n        item.percent = item.count / largestCount * 100 + \"%\";\n\n        if (i >= 1 && _this.statistics[i].Count === _this.statistics[i - 1].Count) {\n          item.rank = _this.orderedMarts[i - 1].rank;\n        } else {\n          item.rank = rank;\n        }\n\n        rank++;\n\n        _this.orderedMarts.push(item);\n      };\n\n      for (var i in this.statistics) {\n        _loop(i);\n      }\n\n      console.log(this.orderedMarts);\n    },\n    selectMart: function selectMart(mart) {\n      this.userOption = this.marts.find(function (element) {\n        return element.mart === mart;\n      }); // console.log(this.userOption);\n\n      this.submitForm(this.userOption.mart);\n    },\n    submitForm: function () {\n      var _submitForm = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee4(targetMart) {\n        var scriptURL, headers, data, resRef, res;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.dataLoading = true;\n\n                if (!this.userVoted) {\n                  _context4.next = 4;\n                  break;\n                }\n\n                Swal.fire({\n                  title: \"user voted\",\n                  type: \"error\"\n                });\n                return _context4.abrupt(\"return\");\n\n              case 4:\n                scriptURL = config.scriptURL;\n                headers = {\n                  headers: {\n                    \"Content-Type\": \"multipart/form-data\"\n                  }\n                };\n                data = new FormData();\n                data.append(\"Name\", targetMart);\n                data.append(\"IP\", this.ip);\n                _context4.prev = 9;\n                _context4.next = 12;\n                return axios.post(scriptURL, data, headers);\n\n              case 12:\n                resRef = _context4.sent;\n                res = resRef.data;\n                console.log(res);\n                this.getData();\n                _context4.next = 21;\n                break;\n\n              case 18:\n                _context4.prev = 18;\n                _context4.t0 = _context4[\"catch\"](9);\n                console.log(_context4.t0);\n\n              case 21:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[9, 18]]);\n      }));\n\n      function submitForm(_x) {\n        return _submitForm.apply(this, arguments);\n      }\n\n      return submitForm;\n    }(),\n    shuffle: function shuffle(array) {\n      var currentIndex = array.length,\n          temporaryValue,\n          randomIndex; // While there remain elements to shuffle...\n\n      while (0 !== currentIndex) {\n        // Pick a remaining element...\n        randomIndex = Math.floor(Math.random() * currentIndex);\n        currentIndex -= 1; // And swap it with the current element.\n\n        temporaryValue = array[currentIndex];\n        array[currentIndex] = array[randomIndex];\n        array[randomIndex] = temporaryValue;\n      }\n\n      return array;\n    },\n    handleResize: function handleResize() {\n      this.window.width = window.innerWidth;\n      this.window.height = window.innerHeight;\n\n      if (this.window.width <= 991) {\n        this.mobile = true;\n      } else {\n        this.mobile = false;\n      }\n    }\n  }\n};",{"version":3,"sources":["App.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"app\">\n    <transition name=\"fade\">\n      <div v-if=\"show\">\n        <el-row>\n          <el-col :sm=\"12\">\n            <div class=\"web-header-img\">\n              <div class=\"web-header-title\">\n                <img src=\"@/assets/img/market-cart.png\" alt />\n                <h2 class=\"NotoSansCJKtc-Bold\">超市減塑 誰當先鋒</h2>\n              </div>\n            </div>\n          </el-col>\n          <el-col :sm=\"12\">\n            <div class=\"web-header\">\n              <!-- if user not voted -->\n              <el-row v-if=\"!userVoted\">\n                <el-col\n                  :xs=\"{span: 5, offset: 3}\"\n                  :sm=\"{span: 5, offset: 0}\"\n                  :md=\"{span: 5, offset: 2}\"\n                  :xl=\"{span: 5, offset: 4}\"\n                >\n                  <h1 class=\"Apercu-Bold\">Q</h1>\n                </el-col>\n                <el-col :xs=\"15\" :sm=\"19\" :md=\"17\" :xl=\"15\">\n                  <h2>\n                    臺灣\n                    <span class=\"Apercu-BoldItalic\">9</span>大連鎖零售業中，\n                    <br />你最想先看到哪家\n                    <span class=\"NotoSansCJKtc-Medium\">達成減塑</span>?\n                  </h2>\n                </el-col>\n                <el-col\n                  v-if=\"!mobile\"\n                  :sm=\"{span: 16, offset: 3}\"\n                  :md=\"{span: 12, offset: 6}\"\n                  :xl=\"{span: 8, offset: 8}\"\n                >\n                  <h3>\n                    <span class=\"NotoSansCJKtc-Bold\">點擊</span>品牌方塊，即可投票\n                  </h3>\n                </el-col>\n                <el-col :span=\"24\" v-if=\"mobile\">\n                  <el-row>\n                    <el-col\n                      :xs=\"{span: 14, offset: 5}\"\n                    >\n                      <h3>\n                        <span class=\"NotoSansCJKtc-Bold\">長按三秒</span> 品牌方塊，即可投票\n                      </h3>\n                    </el-col>\n                  </el-row>\n                </el-col>\n              </el-row>\n              <!-- if user voted -->\n              <el-row v-if=\"userVoted\" type=\"flex\" justify=\"center\" class=\"check-result\">\n                <el-col :sm=\"12\">\n                  <h2>\n                    臺灣\n                    <span class=\"Apercu-BoldItalic\">9</span>大連鎖零售業票選排行\n                  </h2>\n                  <el-button\n                    round\n                    class=\"checkout-statistics NotoSansCJKtc-Regular\"\n                    @click=\"resultDialogVisible = true\"\n                  >看實際票數</el-button>\n                </el-col>\n              </el-row>\n              <!-- mart blocks here -->\n            </div>\n          </el-col>\n          <el-col :sm=\"12\" v-loading=\"dataLoading\">\n            <!-- this is for not voted -->\n            <el-row class=\"mart-block-container\" v-if=\"!userVoted\">\n              <el-col :xs=\"12\" :md=\"8\" v-for=\"(item, index) in marts\" :key=\"index\">\n                <select-mart-block\n                  :img=\"item.img\"\n                  :mart=\"item.mart\"\n                  :mart-eng=\"item.martEng\"\n                  :mobile=\"mobile\"\n                  v-on:selectMart=\"selectMart($event)\"\n                ></select-mart-block>\n              </el-col>\n              <el-col :xs=\"12\" v-if=\"mobile\">\n                <BlankBlock></BlankBlock>\n              </el-col>\n            </el-row>\n            <!-- this is for user voted, shows order -->\n            <el-row class=\"mart-block-container\" v-if=\"userVoted\">\n              <!-- result dialig -->\n              <transition name=\"fade\">\n                <div class=\"result-dialog\" v-if=\"resultDialogVisible\">\n                  <div class=\"result-dialog-content\">\n                    <div v-for=\"(item, index) in orderedMarts\" :key=\"index\">\n                      <el-row :gutter=\"15\">\n                        <el-col :span=\"6\">\n                          <p class=\"NotoSansCJKtc-Regular\">{{ item.mart }}</p>\n                        </el-col>\n                        <el-col :span=\"16\">\n                          <div class=\"progess-bar\">\n                            <div class=\"progess-bar-percent\" :style=\"{ width: item.percent }\"></div>\n                            <p class=\"NotoSansCJKtc-Medium\">{{ item.count }}</p>\n                          </div>\n                        </el-col>\n                      </el-row>\n                    </div>\n                    <el-row>\n                      <el-col :span=\"21\">\n                        <p class=\"NotoSansCJKtc-Medium\">統計單位：人數</p>\n                      </el-col>\n                    </el-row>\n                    <el-row>\n                      <el-col :span=\"24\">\n                        <el-button\n                          @click=\"resultDialogVisible = false\"\n                          class=\"close-dialog NotoSansCJKtc-Regular\"\n                          round\n                        >返回</el-button>\n                      </el-col>\n                    </el-row>\n                  </div>\n                </div>\n              </transition>\n              <el-col :xs=\"12\" :md=\"8\" v-for=\"(item, index) in orderedMarts\" :key=\"index\">\n                <order-mart-block\n                  :img=\"item.img\"\n                  :mart=\"item.mart\"\n                  :mart-eng=\"item.martEng\"\n                  :rank=\"item.rank\"\n                  :selected=\"item.selected\"\n                ></order-mart-block>\n              </el-col>\n              <el-col :xs=\"12\" v-if=\"mobile\">\n                <BlankBlock></BlankBlock>\n              </el-col>\n            </el-row>\n          </el-col>\n        </el-row>\n        <el-row>\n          <el-col :sm=\"24\">\n            <div class=\"web-footer\" v-if=\"!mobile\">\n              <el-row class=\"vertical-center\">\n                <el-col :span=\"6\" :offset=\"3\">\n                  <FooterBTN></FooterBTN>\n                </el-col>\n                <el-col :span=\"7\">\n                  <p>綠色和平致力於為地球發生，我們的存在是因為脆弱的地球需要改變、需要行動。但保護地球的使命不能僅靠綠色和平來完成，「您」就是改變世界的力量！</p>\n                </el-col>\n                <el-col :md=\"{span: 3, offset: 3}\" :xl=\"{span: 3, offset: 4}\">\n                  <p>© 2019 Greenpeace</p>\n                </el-col>\n              </el-row>\n            </div>\n          </el-col>\n        </el-row>\n      </div>\n    </transition>\n    <!-- <HelloWorld msg=\"Welcome to Your Vue.js App\"/> -->\n  </div>\n</template>\n\n<script>\nimport SelectMartBlock from \"./components/SelectMartBlock.vue\";\nimport OrderMartBlock from \"./components/OrderMartBlock.vue\";\nimport BlankBlock from \"./components/BlankBlock.vue\";\nimport FooterBTN from \"./components/FooterBTN.vue\";\nimport config from \"./config/config\";\nimport axios from \"axios\";\nimport Swal from \"sweetalert2\";\n\nexport default {\n  name: \"app\",\n  data() {\n    return {\n      // headerText: \"臺灣9大連鎖零售業中，你最想先看到哪家達成減塑\",\n      window: {\n        width: 0,\n        height: 0\n      },\n      mobile: false,\n      userVoted: false,\n      userOption: false,\n      show: false,\n      dataLoading: false,\n      ip: \"\",\n      statistics: [],\n      orderedMarts: [],\n      resultDialogVisible: false,\n      marts: [\n        {\n          img: require(\"@/assets/img/family-mart.png\"),\n          mart: \"全家\",\n          martEng: \"FamilyMart\",\n          selected: false\n        },\n        {\n          img: require(\"@/assets/img/carrefour.png\"),\n          mart: \"家樂福\",\n          martEng: \"Carrefour\",\n          selected: false\n        },\n        {\n          img: require(\"@/assets/img/costco.png\"),\n          mart: \"好市多\",\n          martEng: \"Costco\",\n          selected: false\n        },\n        {\n          img: require(\"@/assets/img/px-mart.png\"),\n          mart: \"全聯\",\n          martEng: \"PX Mart\",\n          selected: false\n        },\n        {\n          img: require(\"@/assets/img/rt-mart.png\"),\n          mart: \"大潤發\",\n          martEng: \"RT-Mart\",\n          selected: false\n        },\n        {\n          img: require(\"@/assets/img/7-11.jpg\"),\n          mart: \"7-ELEVEN\",\n          martEng: \"7-ELEVEN\",\n          selected: false\n        },\n        {\n          img: require(\"@/assets/img/wellcome.jpg\"),\n          mart: \"頂好\",\n          martEng: \"Wellcome\",\n          selected: false\n        },\n        {\n          img: require(\"@/assets/img/simple-mart.png\"),\n          mart: \"美廉社\",\n          martEng: \"Simple Mart\",\n          selected: false\n        },\n        {\n          img: require(\"@/assets/img/a-mart.png\"),\n          mart: \"愛買\",\n          martEng: \"a.mart\",\n          selected: false\n        }\n      ]\n    };\n  },\n  components: {\n    SelectMartBlock,\n    OrderMartBlock,\n    FooterBTN,\n    BlankBlock,\n  },\n  async created() {\n    window.addEventListener(\"resize\", this.handleResize);\n    this.handleResize();\n    await this.getIP();\n    this.getData();\n  },\n  methods: {\n    async getIP() {\n      let ipRef = await axios.get(\n        `https://api.ipify.org?format=json&callback=`\n      );\n\n      let ip = ipRef.data.ip;\n      this.ip = ip;\n      this.show = true;\n    },\n    async getData() {\n      try {\n        this.dataLoading = true;\n        let data = new FormData();\n\n        let resRef = await axios.get(`${config.scriptURL}?ip=${this.ip}`);\n\n        let res = resRef.data;\n\n        this.userOption = res.target;\n        // console.log(this.userOption);\n        this.statistics = res.data;\n        if (this.userOption.Name) {\n          this.userVoted = true;\n        } else {\n          this.marts = this.shuffle(this.marts);\n        }\n\n        this.filterStatiscs();\n\n        this.dataLoading = false;\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    filterStatiscs() {\n      this.orderedMarts = [];\n      this.statistics.sort(function(a, b) {\n        return b.Count - a.Count;\n      });\n\n      let rank = 1;\n      let largestCount = Math.max.apply(\n        Math,\n        this.statistics.map(o => {\n          return o.Count;\n        })\n      );\n\n      for (let i in this.statistics) {\n        let op = this.statistics[i];\n        let item = this.marts.find(element => {\n          return element.mart === op.Name;\n        });\n        if (item.mart === this.userOption.Name) {\n          item.selected = true;\n        }\n        item.count = this.statistics[i].Count;\n        item.percent = (item.count / largestCount) * 100 + \"%\";\n        if (\n          i >= 1 &&\n          this.statistics[i].Count === this.statistics[i - 1].Count\n        ) {\n          item.rank = this.orderedMarts[i - 1].rank;\n        } else {\n          item.rank = rank;\n        }\n        rank++;\n        this.orderedMarts.push(item);\n      }\n      console.log(this.orderedMarts);\n    },\n    selectMart(mart) {\n      this.userOption = this.marts.find(element => {\n        return element.mart === mart;\n      });\n      // console.log(this.userOption);\n      this.submitForm(this.userOption.mart);\n    },\n    async submitForm(targetMart) {\n      this.dataLoading = true;\n      if (this.userVoted) {\n        Swal.fire({\n          title: \"user voted\",\n          type: \"error\"\n        });\n        return;\n      }\n      const scriptURL = config.scriptURL;\n\n      let headers = {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      };\n\n      let data = new FormData();\n\n      data.append(\"Name\", targetMart);\n      data.append(\"IP\", this.ip);\n\n      try {\n        let resRef = await axios.post(scriptURL, data, headers);\n        let res = resRef.data;\n\n        console.log(res);\n        this.getData();\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    shuffle(array) {\n      let currentIndex = array.length,\n        temporaryValue,\n        randomIndex;\n\n      // While there remain elements to shuffle...\n      while (0 !== currentIndex) {\n        // Pick a remaining element...\n        randomIndex = Math.floor(Math.random() * currentIndex);\n        currentIndex -= 1;\n\n        // And swap it with the current element.\n        temporaryValue = array[currentIndex];\n        array[currentIndex] = array[randomIndex];\n        array[randomIndex] = temporaryValue;\n      }\n\n      return array;\n    },\n    handleResize() {\n      this.window.width = window.innerWidth;\n      this.window.height = window.innerHeight;\n      if (this.window.width <= 991) {\n        this.mobile = true;\n      } else {\n        this.mobile = false;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\n@import \"assets/css/main.css\";\n#app {\n  font-family: NotoSansCJKtc-Regular, Apercu-BoldItalic;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\nbody {\n  margin: 0;\n}\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.5s;\n}\n.fade-enter, .fade-leave-to /* .fade-leave-active below version 2.1.8 */ {\n  opacity: 0;\n}\n// web version\n.web-header-img {\n  width: 100%;\n  height: 100vh;\n  overflow: hidden;\n  background-image: url(\"./assets/img/web-banner.png\");\n  background-repeat: no-repeat;\n  background-size: 100% 100%;\n  background-position: center bottom;\n  .web-header-title {\n    display: flex;\n    position: absolute;\n    top: 11%;\n    left: 3%;\n    color: white;\n    img {\n      width: 50px;\n      height: 40px;\n      transform: translateY(25%);\n      margin-right: 25px;\n    }\n    h2 {\n      margin: 0;\n      font-weight: 100;\n      font-size: 2.2rem;\n      letter-spacing: 7.12pt;\n    }\n  }\n}\n.web-header {\n  @media (min-width: 992px) and (max-width: 1919px) {\n    h1 {\n      margin: 5px 0 0 0 !important;\n    }\n    h2 {\n      margin-top: 40px !important;\n    }\n  }\n  h1 {\n    margin: 25px 0 0 0;\n    font-weight: 100;\n    font-size: 9rem;\n    letter-spacing: 18pt;\n  }\n  h2 {\n    margin-top: 60px;\n    text-align: left;\n    font-weight: 100;\n    line-height: 30pt;\n    letter-spacing: 3.51pt;\n  }\n  h3 {\n    text-align: center;\n    font-weight: 100;\n    letter-spacing: 3.51pt;\n    border-left: 1px solid white;\n    border-right: 1px solid white;\n    margin: 0;\n  }\n  height: 25vh;\n  background-color: rgb(235, 144, 98);\n  color: #fff;\n\n  .check-result {\n    position: relative;\n    top: 20px;\n    h2 {\n      text-align: center;\n    }\n    .el-button {\n      border-color: white;\n      background-color: rgb(235, 144, 98);\n      color: white;\n      letter-spacing: 2.1pt;\n    }\n  }\n}\n.result-dialog {\n  position: absolute;\n  z-index: 300;\n  top: 0;\n  left: 0;\n  background-color: rgba(122, 122, 122, 0.51);\n  width: 100%;\n  height: 75vh;\n  .result-dialog-content {\n    padding: 45px 0;\n    background-color: white;\n    width: 70%;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n    position: relative;\n    border-radius: 50pt;\n    letter-spacing: 2.15pt;\n    p {\n      text-align: right;\n    }\n    .el-row {\n      .progess-bar {\n        display: flex;\n        padding: 0 25px;\n        .progess-bar-percent {\n          position: relative;\n          transform: translateY(50%);\n          background-color: rgb(251, 210, 73);\n          height: 30px;\n        }\n        p {\n          margin-left: 30px;\n        }\n      }\n    }\n    .close-dialog {\n      background-color: rgb(235, 144, 98);\n      color: white;\n      letter-spacing: 2.15pt;\n    }\n  }\n}\n\n.web-footer {\n  position: relative;\n  z-index: 500;\n  margin-top: -5px;\n  background-color: rgb(235, 144, 98);\n  color: #fff;\n  height: 25vh;\n  letter-spacing: 1.56pt;\n  vertical-align: middle;\n  .el-row {\n    text-align: left;\n    p {\n      position: relative;\n      font-size: 0.8rem;\n      margin-top: 30px;\n    }\n  }\n  .vertical-center {\n    position: relative;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n}\n\n.mart-block-container {\n  border: none;\n  overflow: hidden;\n}\n\n@media (max-width: 767px) {\n  .web-header-img {\n    background-image: url(\"./assets/img/mobile-banner.png\");\n    background-repeat: no-repeat;\n    background-size: 100% auto;\n    background-position: center bottom;\n    height: auto;\n    .web-header-title {\n      position: relative;\n      padding: 170px 0 20px 14px;\n      color: white;\n      img {\n        width: 22px;\n        height: 16px;\n        transform: translateY(36%);\n        margin-right: 6px;\n      }\n      h2 {\n        margin: 0;\n        font-weight: 100;\n        font-size: 1.5rem;\n        letter-spacing: 3.56pt;\n      }\n    }\n  }\n  .web-header {\n    h1 {\n      margin: 25px 0 0 0;\n      font-size: 5rem;\n    }\n    h2 {\n      margin: 40px 0 0 0;\n      font-size: 1.2rem;\n      text-align: left;\n      font-weight: 100;\n      line-height: 20pt;\n      letter-spacing: 1.75pt;\n    }\n    h3 {\n      font-size: 1rem;\n      text-align: center;\n      font-weight: 100;\n      letter-spacing: 1.5pt;\n      margin-top: 35px;\n    }\n  }\n\n  .result-dialog {\n    position: absolute;\n    z-index: 300;\n    top: 0;\n    left: 0;\n    background-color: rgba(122, 122, 122, 0.51);\n    width: 100%;\n    height: 75vh;\n    .result-dialog-content {\n      padding: 45px 0;\n      background-color: white;\n      width: 70%;\n      left: 50%;\n      top: 50%;\n      transform: translate(-50%, -50%);\n      position: relative;\n      border-radius: 50pt;\n      letter-spacing: 2.15pt;\n      p {\n        text-align: right;\n      }\n      .el-row {\n        .progess-bar {\n          display: flex;\n          padding: 0 25px;\n          .progess-bar-percent {\n            position: relative;\n            transform: translateY(50%);\n            background-color: rgb(251, 210, 73);\n            height: 30px;\n          }\n          p {\n            margin-left: 30px;\n          }\n        }\n      }\n      .close-dialog {\n        background-color: rgb(235, 144, 98);\n        color: white;\n        letter-spacing: 2.15pt;\n      }\n    }\n  }\n\n  .web-footer {\n    position: relative;\n    z-index: 500;\n    margin-top: -5px;\n    background-color: rgb(235, 144, 98);\n    color: #fff;\n    height: 25vh;\n    letter-spacing: 1.56pt;\n    vertical-align: middle;\n    .el-row {\n      text-align: left;\n      p {\n        position: relative;\n        font-size: 0.8rem;\n        margin-top: 30px;\n      }\n    }\n    .vertical-center {\n      position: relative;\n      top: 50%;\n      transform: translateY(-50%);\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src"}]}